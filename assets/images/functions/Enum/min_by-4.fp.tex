\tikzset{
  sorter/.style={
    fun={\texttt{sorter}},
    function arity=2,
    font=\normalsize,
  }
}

\matrix [list=a] {
  \node [index=1]; &
  \node [index=2]; &
  \node [index=3]; &
  \node [elements between]; &
  \node [index=n]; \\
};

\foreach \i in {1,2,3,n}{
  \draw [->] (a\i.south) -- +(0, -.5)
    node (fun \i) [fun, anchor=in];
  \draw [->] (fun \i.out) -- +(0, -.5)
    node (b\i) [below] {$w_\i$};
}

\coordinate (x) at ($ (b1.south)!.5!(b2.south) $);
\node (sorter 1) [sorter, below=1 of x];

\coordinate (x) at ($ (b2.south)!.5!(b3.south) $);
\node (sorter 2) [sorter, below=1 of x];

\node (sorter n) [sorter, below=1 of bn, anchor=in 2];

\draw [->, out=270, in=90] (b1.south) to (sorter 1.in 1);
\draw [->, out=270, in=90] (b2.south) to (sorter 1.in 2);
\draw [->, out=270, in=90] (b3.south) to (sorter 2.in 2);

\draw [->] (sorter 1.out) -- +(0, -1)
  node (res 1) [below, font=\Large] {$\true \Rightarrow a_1$};

\coordinate (rule) at ($ (b1)!.5!(sorter 1.in) $);
\coordinate (x) at ($ (sorter 1)!.5!(sorter 2) $);
\draw [->] (x |- res 1.north) -- (\currcoord |- rule) -| (sorter 2.in 1);

\draw [->] (sorter 2.out) -- +(0, -1.5)
  node (res 2) [below, font=\Large] {$\false \Rightarrow a_3$};

\draw [->] (bn.south) -- (sorter n.in 2);
\draw [->, dashed] (res 2.19) -- (\currcoord |- rule) -| (sorter n.in 1);

\draw [->] (sorter n.out) -- +(0, -1)
  node (res n) [below, font=\Large] {$\true \Rightarrow a_i$};

\node [right=of res n] {$\texttt{fun}(a_i) \le_{\small\texttt{sorter}} \texttt{fun}(a_j) \forall i \ne j$};

